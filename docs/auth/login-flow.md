# 로그인 및 권한 계획

## 1. 계정 유형

| 역할 | 설명 | 인증 방법 | 주요 권한 |
|------|------|-----------|-----------|
| 일반 선생님 | 대부분의 선생님 | 공통 "선생님 비밀번호" | 시간표 보기, 수정 요청 작성 |
| 관리 선생님 | 승인 담당 선생님 | "관리자 비밀번호" (일반 비번과 별도) | 수정 요청 승인/거절, 템플릿 수정 |
| 최고 관리자 | 원장님 (JaekwonJo) | 관리 비밀번호 + 환경 설정 접근 | 모든 기능 + 비밀번호 변경 |

- 비밀번호는 초기에는 `.env` 파일에 저장 (예: `TEACHER_PASSWORD`, `ADMIN_PASSWORD`).
- 향후에는 DB에 저장하거나 설정 화면에서 변경할 수 있도록 확장 예정.

## 2. 인증 흐름

1. 로그인 화면에서 역할을 선택 (일반 / 관리자).
2. 비밀번호 입력 후 서버에 `/api/auth/login` 요청.
3. 서버는 비밀번호를 검증하고 역할(`teacher`, `manager`)을 토큰(JWT)으로 발급. (유효 시간: **24시간**)
4. 프론트는 토큰을 `localStorage` 또는 `cookie`에 저장하고, 이후 API 요청 시 헤더에 포함. 만료 시 자동 로그아웃.
5. 최고 관리자는 관리자 비밀번호로 로그인 후 추가 설정 화면에서 접근 권한 부여.

```
[로그인 폼] --POST--> /api/auth/login --(비밀번호 검증)-->
  └─ 성공: { token, role } → 프론트 저장 → 대시보드 이동
  └─ 실패: 에러 메시지 표시
```

## 3. 화면별 접근 제어

| 화면 | 일반 선생님 | 관리 선생님 |
|------|-------------|--------------|
| 시간표 보기 | ✅ | ✅ |
| 수정 요청 작성 | ✅ | ✅ |
| 수정 요청 승인/거절 | ❌ | ✅ |
| 템플릿 이름/설명 수정 | ❌ | ✅ |
| 비밀번호 설정 | ❌ | 최고 관리자 전용 |

- 프론트에서 라우터 가드를 사용해 역할별로 화면 접근을 제한.
- 서버에서도 라우트별로 역할을 검사하여 이중으로 보안 유지.

## 4. 구현 체크리스트

### 백엔드
- [ ] `.env`에서 비밀번호 로드 (`dotenv` 사용 예정)
- [ ] `/api/auth/login` 라우트에서 역할별 인증
- [ ] JWT 또는 Signed Cookie 발급 (만료 시간 24시간)
- [ ] 인증 미들웨어(`requireTeacher`, `requireManager`) 작성
- [ ] 역할별 접근 제한이 필요한 API에 미들웨어 적용

### 프론트엔드
- [ ] 로그인 페이지 컴포넌트 (`LoginPage`)
- [ ] 인증 상태를 관리하는 컨텍스트/스토어 (`useAuth`)
- [ ] 역할별 라우팅 가드 (예: `ProtectedRoute` 컴포넌트)
- [ ] 로그아웃 기능 및 토큰 만료 처리
- [ ] 비밀번호 변경 화면은 추후(패치 계획)에 포함

## 5. 추후 확장 아이디어
- 비밀번호 변경 UI: 최고 관리자만 접근
- 선생님 개인 계정 추가 (이메일 + 임시 비밀번호) → 아직은 미룬다.
- 2단계 인증(선택 사항): 추후 필요 시 고려

---

*핵심 기능 완성 후, 보안 강화를 위해 순차적으로 확장할 예정입니다.*
