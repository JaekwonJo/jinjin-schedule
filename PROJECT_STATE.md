# 📊 PROJECT_STATE.md - 진진영어 시간표 현황

**마지막 업데이트**: 2025-10-04 01:45 (KST)

## What
- 400명 학생의 주간 시간표를 안전하게 만들고 공유·인쇄까지 지원하는 진진영어 학원 전용 웹 시스템입니다.

## Stack
- **Frontend**: React 19 (CRA), Context API, custom modals/notifications
- **Backend**: Node.js + Express 5, Nodemailer 스텁
- **Database**: SQLite (templates, schedule_entries, change_requests, users)

## Decisions
- 선생님은 직접 가입 요청 → superadmin 승인 후 로그인 (역할 기반 권한)
- 시간표 셀은 `{teacher, students, notes, color}` 구조로 저장하여 담당 선생님·학생·메모를 함께 관리
- 승인/거절 알림은 토스트·배지·이메일 스텁까지 동일한 API(`change_requests`)에서 처리
- 인쇄 미리보기는 학원 로고 + 일요일 강조 컬럼을 갖춘 모달로 제공
- superadmin은 헤더의 "테스트 메일" 버튼으로 SMTP 설정을 즉시 검증
- 전체/선생님별 보기 토글과 CSV 업로드/검증(베타)로 운영 흐름을 빠르게 전환
- 셀 선택 모드에서 색상 변경·복사/붙여넣기·재배치까지 한 번에 지원해 스프레드시트 수준의 편집 UX를 지향
- CSV 내보내기/왕복 검증을 전용 API로 제공해 데이터 누락을 사전에 차단

## Current Stage
- 로그인 → 수정 요청 → 승인/거절 → 알림 → 인쇄 흐름을 실제 데이터와 함께 검증 가능한 베타 단계입니다.
- 인쇄 미리보기·요청 히스토리·알림 로그·CSV 업로드/다운로드·검증까지 연결되어 운영 리허설을 진행할 수 있습니다.
- 셀 선택 모드, 색상 일괄 변경, 복사/붙여넣기, 재배치 기능으로 대량 편집도 구글시트 수준으로 안정화되고 있습니다.

## Next 3 Steps
1. **드래그 앤 드롭 이동** – 선택한 셀을 마우스로 바로 끌어 이동하도록 미리보기/충돌 처리 UX 구현.
2. **미니 툴바 & 단축키 안내** – 선택 시 화면에 고정된 툴바/도움말을 띄워 누구나 직관적으로 사용할 수 있게 보강.
3. **고급 붙여넣기 & 자동 확대** – 범위 크기가 달라도 자동으로 맞춰 붙여넣고 오류 없이 되돌릴 수 있는 편집 보정 로직 추가.

## Known Issues
- 인쇄 모달이 매우 긴 시간표를 인쇄할 때 페이지 분할 위치가 들쭉날쭉하여 수기 조정이 필요합니다.
- SMTP는 성공/실패 메시지를 즉시 보여주지만, 누가 어떤 메일을 받았는지 아카이브가 없어 추후 추적이 어렵습니다.
- 요청 히스토리는 여전히 클라이언트 필터에 의존해 수천 건 이상일 때 속도가 느려질 수 있습니다.
- 붙여넣기/이동은 동일 크기 범위를 전제로 하므로 자동 확장·충돌 가이드를 추가해야 합니다.
- 드래그 앤 드롭 이동, 더 직관적인 미니 툴바, 키보드 가이드 등 초보자용 UX가 미완성입니다.

## Resolved (금일)
- 셀 선택 모드에서 Shift/Ctrl 조합으로 범위를 지정하고 색상 일괄 변경, 복사/붙여넣기를 지원합니다.
- 선택한 셀을 다른 시간·요일로 이동할 수 있는 `위치 이동` 기능과 충돌 확인 경고를 추가했습니다.
- 복사/붙여넣기, 이동, 색상 변경에 대한 키보드 단축키(Esc, Ctrl/Cmd+C/V)를 연결했습니다.
- CSV 내보내기 및 `/validate-csv` 검증 API를 추가하고 UI 버튼으로 바로 사용할 수 있게 했습니다.
- README/샘플 CSV를 최신 포맷으로 갱신해 업로드·편집 절차가 더 손쉬워졌습니다.

---

**전체 진행률**: 68% (핵심 흐름 완성, 데이터 임포트/보고 고도화 단계)
