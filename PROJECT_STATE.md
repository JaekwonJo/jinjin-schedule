# 📊 PROJECT_STATE.md - 진진영어 시간표 현황

**마지막 업데이트**: 2025-10-02 23:10 (KST)

## What
- 400명 학생의 주간 시간표를 안전하게 만들고 공유·인쇄까지 지원하는 진진영어 학원 전용 웹 시스템입니다.

## Stack
- **Frontend**: React 19 (CRA), Context API, custom modals/notifications
- **Backend**: Node.js + Express 5, Nodemailer 스텁
- **Database**: SQLite (templates, schedule_entries, change_requests, users)

## Decisions
- 선생님은 직접 가입 요청 → superadmin 승인 후 로그인 (역할 기반 권한)
- 시간표 셀은 `{students, notes, color}` 구조로 저장하여 색상 강조 및 메모 표시
- 승인/거절 알림은 토스트·배지·이메일 스텁까지 동일한 API(`change_requests`)에서 처리
- 인쇄 미리보기는 학원 로고 + 일요일 강조 컬럼을 갖춘 모달로 제공
- superadmin은 헤더의 "테스트 메일" 버튼으로 SMTP 설정을 즉시 검증

## Current Stage
- 로그인 → 수정 요청 → 승인/거절 → 알림 → 인쇄 흐름을 실제 데이터와 함께 검증 가능한 베타 단계입니다.
- 인쇄 미리보기·요청 히스토리·알림 테스트 도구까지 연결되어 운영 리허설을 진행할 수 있습니다.
- 테스트 메일 결과와 요청 필터가 화면에 남아 운영 중에도 문제를 즉시 발견할 수 있습니다.

## Next 3 Steps
1. **A4 인쇄 페이지 마감** – 시간표가 여러 장으로 나뉠 때 페이지 나눔/머리글을 다듬어 실제 인쇄본을 안정화.
2. **SMTP 발송 로그 시각화** – 테스트뿐 아니라 승인/거절 발송 내역을 조회하고 실패 알림을 대시보드에 표시.
3. **요청 히스토리 서버 필터** – 대용량 데이터를 위해 서버에서 조건 검색·페이징을 제공하고 클라이언트는 결과만 표시.

## Known Issues
- 인쇄 모달이 매우 긴 시간표를 인쇄할 때 페이지 분할 위치가 들쭉날쭉하여 수기 조정이 필요합니다.
- SMTP는 성공/실패 메시지를 즉시 보여주지만, 누가 어떤 메일을 받았는지 아카이브가 없어 추후 추적이 어렵습니다.
- 요청 히스토리는 여전히 클라이언트 필터에 의존해 수천 건 이상일 때 속도가 느려질 수 있습니다.

## Resolved (금일)
- 학원 로고·일요일 강조·색상 전설을 포함한 인쇄 미리보기를 정돈해 긴 메모와 색상도 보기 쉽게 정렬했습니다.
- 셀 편집 모달에서 학생·메모·색상을 한 번에 저장하도록 통합해 입력 실수를 줄였습니다.
- 승인/거절 알림이 토스트·배지·읽음 처리로 동기화되어 선생님도 즉시 결과를 확인합니다.
- `/api/notifications/test` 엔드포인트와 헤더 버튼을 연결하고 성공/실패 알림 배너를 추가해 SMTP 문제를 바로 파악합니다.
- 요청 히스토리 패널에 상태·템플릿·기간 필터를 추가하고 최근 값을 기억해 필요한 기록만 골라볼 수 있습니다.

---

**전체 진행률**: 62% (핵심 흐름 완성, 보고/알림 고도화 단계)
